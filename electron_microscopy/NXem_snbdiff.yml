#kuehbacm at hu-berlin.de, 12/2021
#using NXem_draft class to instantiate an application definition for scanning nanobeam diffraction.
name: NXem_snbdiff
category: application definition
doc: Application definition for scanning nanobeam diffraction in a transmission electron microscope.
symbols:
  doc: The symbols used in the schema to specify e.g. dimensions of arrays
  imageid: Frame or given number to distinguish different images in a stack
  ypos: Pixel coordinate in the slow-changing direction
  xpos: Pixel coordinate in the fast-changing direction
  nimages: Total number of images in the imagestack
  ny: Number of pixel along the slow-changing direction
  nx: Number of pixel along the fast-changing direction
(NXentry):
  exists: required
  doc: Application definition for storing data and metadata for experiments with (scanning and transmission) electron microscopy
  (NXdata):
    exists; required
    doc: Hard link to a location/locations in the hierarchy of the NeXus file where the data for default plotting are stored.
      imagestack(link):
        target:
  scan_align(NXprocess):
    #extending the scan_align(NXprocess) rest is inherited
    misc(NXcollection):
      #the following three members are specific for an application definition which uses NXem_draft as a base but then adds NXprocesses with internal NXcollections which are specific for the application case/experiment type, such as scanning nanobeam diffraction, ptychography, EBSD, FIB milling etc.
      cartesian_scan_dimensions(NX_UINT):
        doc: to be defined
      cartesian_scan_dimension1_count(NX_UINT):
        doc: to be defined
      cartesian_scan_dimension2_count(NX_UINT):
        doc: to be defined
    acquired_data(NXdata):
      doc: A stack of two-dimensional images with imageid changing slowest, ypos changing faster, and xpos changing fastest, i.e. xpos + ypos * nx + imageid * nx*ny implicit C-style indexing.
      \@signal: imagestack
      \@axes: [imageid, ypos, xpos]
      \@imageid_indices: 2
      \@ypos_indices: 1
      \@xpos_indices: 0
      data(NX_FLOAT):
        dimensions:
          rank: 3
          dim: [[3, nimages], [2, ny], [1, nx]]
      imageid(NX_UINT):
        dimensions:
          rank: 1
          dim: [[3, nimages]]
        \@long_name:
          doc: Label for the image axis
      ypos(NX_NUMBER):
        dimensions:
          rank: 1
          dim: [[2, ny]]
        \@long_name:
          doc: Label for the y axis
      xpos(NX_NUMBER):
        dimensions:
          rank: 1
          dim: [[1, nx]]
        \@long_name:
          doc: Label for the x axis
      title:
    series_params(NXdata):
      doc: A collection of parameter pairs for each image, i.e. 0 or 1 + imageid * 2 implicit indexing
      data(NX_NUMBER):
        dimensions:
          rank: 2
          dim: [[2, nimages], [1, 2]]
    aligned_positions(NXdata):
      doc: A collection of alignment position quintets for each image, i.e. 0, 1, ..., 4 + imageid * 5 implicit indexing
      data(NX_NUMBER):
      dimensions:
        rank: 2
        dim: [[2, nimages], [1, 5]]
#everything else we inherit from NXem_draft
